# Zircon Fun Tools ユーザーガイド

このドキュメントは、Discord Botの利用者向けの説明書です。各コマンドの使い方と機能について説明します。

---

## 📋 目次

1. [コマンド一覧](#コマンド一覧)
2. [誕生日機能](#1-誕生日機能-birthday)
3. [占い機能](#2-占い機能-oracle)
4. [抽選機能](#3-抽選機能-lottery)
5. [ポスター生成機能](#4-ポスター生成機能-poster)
6. [名言機能](#5-名言機能-quote)
7. [よくある質問](#よくある質問-faq)

---

## コマンド一覧

| コマンド | 説明 | 権限 |
|---------|------|------|
| `/birthday` | 誕生日一覧を表示・検索 | 全員 |
| `/birthday_update` | 誕生日データを一括更新 | 管理者 |
| `/birthday_toggle` | 誕生日自動投稿のON/OFF | 管理者 |
| `/birthday_schedule` | 誕生日通知の時刻を設定 | 管理者 |
| `/oracle` | 選択肢からランダムに占う | 全員 |
| `/lottery` | ロールメンバーから抽選 | 全員※ |
| `/poster` | キャラクターポスターを生成 | 全員 |
| `/quote` | 名言一覧を表示・検索 | 全員 |
| `/quote_update` | 名言データを一括更新 | 管理者 |
| `/quote_toggle` | 名言定期投稿のON/OFF | 管理者 |
| `/quote_schedule` | 名言定期投稿のスケジュール設定 | 管理者 |

※ 権限はDiscordサーバーの設定で変更できます。

---

## 1. 誕生日機能 (`/birthday`)

Zirconキャラクターの誕生日を管理し、自動でお祝いメッセージを投稿する機能です。

### `/birthday` - 誕生日を検索・一覧表示

```
/birthday [id_or_name]
```

**パラメータ:**
- `id_or_name`（オプション）: キャラクターIDまたは名前で検索

**使用例:**
- `/birthday` - 全ての誕生日を一覧表示（ページネーション付き）
- `/birthday 123` - ID「123」のキャラクターを検索
- `/birthday リオン` - 名前に「リオン」を含むキャラクターを検索

**結果表示:**
- 誕生日は `ID, キャラクター名 : birthday(MM/DD)` の形式で表示されます
- ページ移動ボタン（◀ 前へ / 次へ ▶）で一覧を閲覧できます

---

### `/birthday_update` - 誕生日データの一括更新（管理者専用）

```
/birthday_update file:<CSV/JSONファイル>
```

**パラメータ:**
- `file`: アップロードするCSVまたはJSONファイル

**CSVフォーマット:**
```csv
character_id,name,month,day
123,リオン,3,15
456,アリア,7,20
```

**JSONフォーマット:**
```json
[
  {"character_id": "123", "name": "リオン", "month": 3, "day": 15},
  {"character_id": "456", "name": "アリア", "month": 7, "day": 20}
]
```

⚠️ **注意:** このコマンドは既存のデータを**全て置換**します。

---

### `/birthday_toggle` - 自動投稿のON/OFF（管理者専用）

```
/birthday_toggle enabled:<true|false>
```

**パラメータ:**
- `enabled`: `true`で有効化、`false`で無効化

---

### `/birthday_schedule` - 投稿時刻の設定（管理者専用）

```
/birthday_schedule hour:<時>
```

**パラメータ:**
- `hour`: 投稿する時刻（0〜23、日本時間）

**使用例:**
- `/birthday_schedule hour:9` - 毎日9:00（JST）に投稿

---

## 2. 占い機能 (`/oracle`)

指定した数の選択肢からランダムに1つを選んでアドバイスします。

### `/oracle` - 選択肢の占い

```
/oracle choices:<選択肢の数>
```

**パラメータ:**
- `choices`: 選択肢の数（1以上の整数）

**使用例:**
- `/oracle choices:3` - 3つの選択肢から占う
- `/oracle choices:10` - 10個の選択肢から占う

**動作:**
1. 「○個の選択肢から占います...」というメッセージが表示されます
2. 3秒後に結果が発表されます
3. ランダムに選ばれた番号とアドバイスメッセージが表示されます

💡 **ヒント:** 迷った時の意思決定に活用してください！

---

## 3. 抽選機能 (`/lottery`)

指定したロールを持つメンバーからランダムに当選者を選出します。

### `/lottery` - 抽選の実行

```
/lottery role:<@ロール> count:<当選者数> [interval:<秒数>]
```

**パラメータ:**
- `role`: 抽選対象のロール（@メンション形式）
- `count`: 当選者数
- `interval`（オプション）: 発表前のインターバル秒数（デフォルト: 20秒、最小: 5秒）

**使用例:**
- `/lottery role:@参加者 count:3` - 「参加者」ロールから3名を抽選
- `/lottery role:@イベント参加 count:5 interval:30` - 30秒インターバルで5名抽選

**演出の流れ:**
1. 「〇人目の当選者を発表します！」と表示
2. インターバルの最後5秒間はカウントダウン（5...4...3...2...1...）
3. 当選者が発表されます（🎉 メンション付き）
4. **Next** ボタンで次の当選者へ
5. 最後に全当選者一覧が表示されます

**ボタン操作:**
- ▶️ **Next**: 次の当選者の発表に進む
- ⏹️ **キャンセル**: 抽選を中断（途中結果の表示を選択可能）

⚠️ **注意:** ボタン操作は抽選を開始したユーザーのみ可能です。

---

## 4. ポスター生成機能 (`/poster`)

キャラクター情報からオリジナルポスター画像を生成します。

### `/poster` - ポスターの生成

```
/poster character_id:<キャラクターID>
```

**パラメータ:**
- `character_id`: Zirconキャラクターの公式ID

**使用例:**
- `/poster character_id:123` - ID「123」のキャラクターポスターを生成

**動作:**
1. 公式サイトからキャラクター情報を取得
2. キャラクター画像とステータス情報を合成
3. 生成されたポスター画像がチャンネルに投稿されます

💡 **ヒント:** キャラクターIDは `/birthday` コマンドで確認できます。

---

## 5. 名言機能 (`/quote`)

キャラクターの名言を管理し、定期的に自動投稿する機能です。

### `/quote` - 名言を検索・一覧表示

```
/quote [keyword]
```

**パラメータ:**
- `keyword`（オプション）: 検索キーワード（発言者名や本文で検索）

**使用例:**
- `/quote` - 全ての名言を一覧表示
- `/quote リオン` - 「リオン」に関連する名言を検索
- `/quote 勝負` - 「勝負」を含む名言を検索

**表示内容:**
- 発言者名、名言本文、キャラクターID（登録されている場合）
- ページ移動ボタンで一覧を閲覧可能

---

### `/quote_update` - 名言データの一括更新（管理者専用）

```
/quote_update file:<CSV/JSONファイル>
```

**パラメータ:**
- `file`: アップロードするCSVまたはJSONファイル

**CSVフォーマット（UTF-8）:**
```csv
speaker,text,character_id
リオン,この勝負、もらった！,123
アリア,やるしかないんだ！,045
ナレーター,物語は続く...
```

**各列の説明:**
- `speaker`（必須）: 発言者の名前
- `text`（必須）: 名言の本文
- `character_id`（オプション）: キャラクターID（設定するとサムネイル画像が表示される）

⚠️ **注意:** このコマンドは既存のデータを**全て置換**します。

---

### `/quote_toggle` - 定期投稿のON/OFF（管理者専用）

```
/quote_toggle enabled:<true|false>
```

**パラメータ:**
- `enabled`: `true`で有効化、`false`で無効化

---

### `/quote_schedule` - 定期投稿スケジュールの設定（管理者専用）

```
/quote_schedule days:<日数> hour:<時> minute:<分>
```

**パラメータ:**
- `days`: 投稿間隔（日数）
- `hour`: 投稿時刻（時、0〜23）
- `minute`: 投稿時刻（分、0〜59）

**使用例:**
- `/quote_schedule days:1 hour:9 minute:0` - 毎日9:00に投稿
- `/quote_schedule days:3 hour:12 minute:30` - 3日ごとの12:30に投稿

---

### 定期投稿の表示形式

定期投稿される名言は、以下の形式で表示されます：

```
┌─────────────────────────────────┐
│  [キャラクター画像]              │
│                                 │
│  発言者名（タイトル）            │
│  「名言本文」（説明）            │
│                                 │
│  #123 · quote_id:abc-123       │
│  （フッター）                   │
└─────────────────────────────────┘
```

- キャラクターIDが登録されている場合、公式サイトへのリンクも設定されます
- 同じ名言が連続で投稿されることはありません

---

## よくある質問 (FAQ)

### Q: コマンドが見つからない/使えない

**A:** 以下を確認してください：
1. Botがサーバーに正しく招待されているか
2. Botがコマンドを使うチャンネルへのアクセス権限を持っているか
3. コマンドの実行権限がDiscordサーバー設定で許可されているか

権限の設定は、サーバー設定 > 連携サービス > アプリ > [Bot名] から変更できます。

---

### Q: 誕生日/名言の自動投稿が来ない

**A:** 以下を確認してください：
1. 自動投稿が有効になっているか（`/birthday_toggle enabled:true` または `/quote_toggle enabled:true`）
2. 投稿先チャンネルが正しく設定されているか（管理者に確認）
3. Botがそのチャンネルへの投稿権限を持っているか

---

### Q: ポスターの画像が正しく生成されない

**A:** 以下が原因として考えられます：
1. キャラクターIDが存在しない/間違っている
2. 公式サイトが一時的に利用できない
3. キャラクターの画像データが未登録

正しいキャラクターIDは `/birthday` コマンドで確認できます。

---

### Q: 抽選で「対象者がいません」と表示される

**A:** 指定したロールを持つメンバーが0人の場合に表示されます。
- ロールの指定が正しいか確認してください
- ロールにメンバーが割り当てられているか確認してください

---

### Q: 名言のキャラクター画像が表示されない

**A:** `character_id` が登録されていない名言は、サムネイル画像なしで投稿されます。
画像を表示したい場合は、名言データにキャラクターIDを追加してください。

---

### Q: 管理者コマンドが使えない

**A:** 管理者コマンド（`_update`, `_toggle`, `_schedule`系）は、デフォルトでDiscordの管理者権限（Administrator）を持つユーザーのみ実行可能です。

権限を変更したい場合は、サーバー設定 > 連携サービス > アプリ > [Bot名] > コマンド権限 から設定してください。

---

## 💬 サポート

問題が解決しない場合は、サーバー管理者にお問い合わせください。

---

**最終更新日**: 2026-01-15
